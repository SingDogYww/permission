# 用户导入功能测试说明

## 功能概述

导入功能支持通过Excel (.xlsx) 或 CSV (.csv) 文件批量导入用户数据，包含完整的验证和错误处理机制。

## 测试步骤

### 1. 打开导入功能
- 在用户管理页面点击"批量导入"按钮
- 系统将打开4步导入向导

### 2. 第一步：下载模板
- 可以下载Excel或CSV格式的导入模板
- 模板包含所有必填和可选字段的说明

### 3. 第二步：上传文件
- 支持拖拽上传或点击选择文件
- 系统会自动解析文件内容并进行格式验证
- 支持的格式：.xlsx, .csv

### 4. 第三步：确认导入
- 显示解析后的数据预览
- 展示有效记录和错误记录的统计
- 只有当有效记录数量大于0且没有格式错误时才能执行导入

### 5. 第四步：查看结果
- 显示导入进度（模拟2秒延迟）
- 展示最终导入结果：成功数量、失败数量
- 详细显示每条记录的导入状态和错误信息

## 测试数据

项目中已准备了测试文件：`public/sample-users.csv`

### 测试数据说明：
1. **张三** - 正常管理员用户（应该成功）
2. **李四** - 正常操作员用户（应该成功）
3. **王五** - 正常查看员用户（应该成功）
4. **赵六** - 正常用户（应该成功）
5. **钱七** - 邮箱格式错误（应该失败）
6. **孙八** - 手机号格式错误（应该失败）
7. **周九** - 角色不存在（应该失败）
8. **吴十** - 用户组不存在（应该失败）
9. **郑十一** - 缺少邮箱（应该失败）
10. **王十二** - 缺少手机号（应该失败）

## 预期结果

使用测试文件导入时：
- **总记录数：** 10条
- **预期成功：** 4条（张三、李四、王五、赵六）
- **预期失败：** 6条（其他记录有各种错误）

实际导入时会有20%的随机失败率，所以最终结果可能略有不同。

## 错误类型

系统会随机产生以下类型的错误：
- 用户名已存在
- 邮箱格式不正确
- 手机号已被使用
- 用户组不存在
- 必填字段缺失
- 数据格式错误

## 交互特性

1. **不能点击外部关闭：** 只能通过"取消"按钮关闭弹窗
2. **步骤导航：** 支持前进和后退（导入开始后不能后退）
3. **实时验证：** 文件上传后立即进行数据验证
4. **结果展示：** 详细的成功/失败统计和每条记录的状态

## 如何测试

1. 访问用户管理页面：http://localhost:5173/permission/users
2. 点击"批量导入"按钮
3. 按照向导步骤操作：
   - 可以先下载模板查看格式
   - 使用 `public/sample-users.csv` 文件进行测试
   - 观察第3步的数据预览和验证结果
   - 执行导入并查看第4步的结果展示

通过这个测试流程，您可以完整体验导入功能的成功和失败场景。 